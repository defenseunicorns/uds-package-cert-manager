includes:
  - setup: ./tasks/setup.yaml
  - create: ./tasks/create.yaml
  - deploy: ./tasks/deploy.yaml
  - remove: ./tasks/remove.yaml
  - publish: ./tasks/publish.yaml

variables:
  - name: FLAVOR
  - name: CERT_MANAGER_VALUES
  - name: CERT_MANAGER_MANIFESTS

tasks:
  - name: setup-cluster-no-istio
    actions:
      - task: setup:k3d-no-istio

  - name: setup-cluster-istio
    actions:
      - task: setup:core-istio

  - name: create-pkg-flavor
    actions:
      - task: create:cert-manager-pkg-flavor

  - name: deploy-pkg-flavor
    actions:
      - task: deploy:cert-manager-pkg-flavor

  - name: remove-pkg-flavor
    actions:
      - task: remove:cert-manager-pkg-flavor

  - name: publish-pkg-flavor
    actions:
      - task: publish:cert-manager-pkg-flavor
